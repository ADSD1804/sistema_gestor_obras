<header class="header">
  <div class="container">    
    <div class="banner_icons">
      <a routerLink="/"><img src="assets/casa.png" alt="Inicio" class="banner_icon"></a>
      <a routerLink="/"><p class="banner_text">Inicio</p></a>
    </div>
  </div>
  <div class="title">
    <h4>Sistema Gestor de Obras</h4>
  </div>
</header>

<main class="main">
  <div class="welcome-container">
    <h2>Bienvenido Supervisor: {{currentUser?.name}}</h2>
    <img [src]="currentUser?.image" alt="Imagen de perfil" class="profile-image">
  </div>

  <section class="task-assignment">
    <h3>Asignar Tarea a Trabajador</h3>
    <form (ngSubmit)="assignTask()">
      <label for="workerSelect">Nombre Trabajador:</label>
      <select id="workerSelect" [(ngModel)]="selectedWorker" name="selectedWorker" (change)="onWorkerChange()" required>
        <option [ngValue]="null" disabled selected>Seleccione un trabajador</option>
        <option *ngFor="let worker of workers" [ngValue]="worker">{{worker.name}}</option>
      </select>

      <label for="email">Correo:</label>
      <input id="email" type="email" [(ngModel)]="email" name="email" readonly />

      <label for="task">Tarea a asignar:</label>
      <textarea id="task" [(ngModel)]="task" name="task" rows="4" required></textarea>

      <button type="submit">Asignar Tarea</button>
    </form>
  </section>

  <section class="all-tasks" *ngIf="allTasks.length > 0">
    <h3>Tareas en Curso y Finalizadas</h3>
    <table>
      <thead>
        <tr>
          <th>Tarea</th>
          <th>Asignada Por</th>
          <th>Nombre Supervisor</th>
          <th>Fecha Asignaci√≥n</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let task of allTasks">
          <td>{{task.task}}</td>
          <td>{{task.assignedBy}}</td>
          <td>{{task.nombre_supervisor}}</td>
          <td>{{task.assignedAt | date:'short'}}</td>
          <td>{{task.estado}}</td>
        </tr>
      </tbody>
    </table>
  </section>

  <section class="ingreso-diario-workers" *ngIf="workers.length > 0">
    <h3>Trabajadores en Ingreso Diario</h3>
    <table>
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Correo</th>
          <th>Zona</th>
          <th>Rol</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let worker of workers">
          <td>{{worker.name}}</td>
          <td>{{worker.email}}</td>
          <td>{{worker.zone}}</td>
          <td>{{worker.role}}</td>
        </tr>
      </tbody>
    </table>
  </section>
</main>
